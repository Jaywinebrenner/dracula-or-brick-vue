function Product(){this.review_requested=false}Product.instance=null;Product.getInstance=function(){if(Product.instance==null){Product.instance=new Product}return Product.instance};Product.prototype.init=function(){var productID=document.getElementById("hidProductID").value;$("#btnReviewAjax").bind("click",this.showReviewForm);$("#btnReviewSubmit").bind("click",this.submitReviewForm);$(".CategoriesContent .ShowMore").bind("click",this.showMoreCategories);this.initQuickPreview();this.initCarousel();window.addEventListener("touchstart",function(){var displayFilter=Cookies.get("RDDisplayFilter");if(displayFilter!=null&&displayFilter.length>0){displayFilter=$.evalJSON(displayFilter)}else{displayFilter={}}displayFilter["enable_quickpreview"]=0;Cookies.set("RDDisplayFilter",displayFilter,{path:"/",expires:100})});if(window.location.href.indexOf("purchase=1")!==-1){setTimeout(function(){$("#FPQuickCheckout").trigger("click")},300)}$(".CheckMateContent .OtherFileTitle").bind("click",function(){$(this).find(".fa").toggleClass("fa-angle-up").toggleClass("fa-angle-down");$("#OtherFileTitleContainer").toggle()})};Product.prototype.initCarousel=function(){var width=$("#wrap").width();if(width>768){var margin=14}else{var margin=20}$(".ReViewedProSection .es-carousel-wrapper").each(function(){$(this).elastislide({margin:margin,border:0,minItems:1,disableNav:true,allowLink:true})})};Product.prototype.initQuickPreview=function(){var _this=this;$(".SectionContent").on("mouseenter click",".thumbnail",function(e){var displayFilter=Cookies.get("RDDisplayFilter");if(displayFilter!=null&&displayFilter.length>0){displayFilter=$.evalJSON(displayFilter);if(displayFilter["enable_quickpreview"]==0){return}}else if(SearchQuickPreview.getInstance().isTouchDevice()){return}var target=e.target?e.target:e.srcElement;if($(target).hasClass("searchPopupOverBoxPlay")){return}if(SearchQuickPreview.getInstance().isTouchDevice()||($(this).find(".searchPopupOverBox").length==0||$(this).find(".searchPopupOverBox").is(":hidden")))e.preventDefault();SearchQuickPreview.getInstance().serviceUrl=serviceUrl;SearchQuickPreview.getInstance().RESTUrl=RESTUrl;SearchQuickPreview.getInstance().intPlay=1;SearchQuickPreview.getInstance().cartPreUrl=cartPreUrl;SearchQuickPreview.getInstance().type="1";SearchQuickPreview.getInstance().currTarget=$(this).parent();SearchQuickPreview.getInstance().enableQuickPreview=true;SearchQuickPreview.getInstance().init()});$(".SectionContent").on("mouseleave",".thumbnail",function(e){e.preventDefault();SearchQuickPreview.getInstance().undoAction()})};Product.prototype.showReviewForm=function(){if(Product.getInstance().review_requested){$("#reviewModel").modal({})}else if(!isLoggedIn()){km_location("sign_in");return false}else{var productID=document.getElementById("hidProductID").value;var arrPostUrl=["format=json&afc=Null&package=Community"];arrPostUrl.push("&op=GetReview");arrPostUrl.push("&ID="+productID);var cache=Math.round(Math.random()*1e4);arrPostUrl.push("&nocache="+cache);$.ajax({type:"GET",url:reviewServiceUrl,data:arrPostUrl.join(""),success:function(response){Product.getInstance().review_requested=true;response=JSON.parse(response);if(response.COMMUNITY_GETREVIEW_REPLY.ERROR==0){var canRate=response.COMMUNITY_GETREVIEW_REPLY.BLRATE;if(canRate==1){$("#btnReviewSubmit").show();$("#reviewFormAction").show();var rate=response.COMMUNITY_GETREVIEW_REPLY.FLTRATE;$("#ratingNow").val(parseInt(rate));var rateCopy=$("#ratingNow").clone();$(".rating-input").remove();rateCopy.prependTo(".divRating").rating();var canReview=response.COMMUNITY_GETREVIEW_REPLY.BLREVIEW;if(canReview==1){$("#reviewTitle").show();$("#reviewContainer").show();if(response.COMMUNITY_GETREVIEW_REPLY.STGREVIEW)$("#reviewText").val(response.COMMUNITY_GETREVIEW_REPLY.STGREVIEW)}else{$("#reviewTitle").hide();$("#reviewContainer").hide();$("#reviewcontent_msg").text(response.COMMUNITY_GETREVIEW_REPLY.MESSAGE)}}else{$("#btnReviewSubmit").hide();$("#reviewFormAction").hide();$("#reviewcontent_msg").text(response.COMMUNITY_GETREVIEW_REPLY.MESSAGE)}}else{$("#reviewFormAction").hide();$("#reviewcontent_msg").text(response.COMMUNITY_GETREVIEW_REPLY.MESSAGE)}$("#reviewModel").modal({})}})}};Product.prototype.submitReviewForm=function(){var productID=$("#hidProductID").val();var intRating=$("#ratingNow").val();var stgText=$("#reviewText").val();var data={format:"json",afc:"null",package:"Community",op:"ReviewProduct",productid:productID,rating:intRating,nocache:Math.round(Math.random()*1e4)};if(stgText.length)data.reviewText=stgText;$.ajax({type:"GET",url:reviewServiceUrl,data:data,success:function(response){location.reload()}})};Product.prototype.showMoreCategories=function(){if($(".CategoriesContent .tagsContentHidden").hasClass("hidden")){$(".CategoriesContent .tagsContentHidden").removeClass("hidden");$(".CategoriesContent .ShowMore").text("Show less...")}else{$(".CategoriesContent .tagsContentHidden").addClass("hidden");$(".CategoriesContent .ShowMore").text("Show more...")}};function getLocalePrefix(){var localePrefix="";if(is_localized&&page_locale!="en_US"){localePrefix="/"+page_locale.toLowerCase()}return localePrefix}function loadFeatureAssignmentWidget(attemptLogin){$.ajax({type:"GET",url:feature_assignment_widget_url,crossDomain:true,xhrFields:{withCredentials:true},success:function(response){$(".js-feature-assignment-widget-classic-container").append(response)},error:function(jqXHR){if(jqXHR.status==401&&attemptLogin){loginToTurbosquidArtist()}}})}function loginToTurbosquidArtist(){if(!$("iframe[src*='"+feature_assignment_login_url+"']").length){var $tsaIframe=$("<iframe></iframe>");$tsaIframe.css("display","none");$tsaIframe.load(function(){$tsaIframe.remove();loadFeatureAssignmentWidget(false)});$tsaIframe.attr("src",feature_assignment_login_url);$("body").append($tsaIframe)}}$(document).ready(function(){Product.getInstance().init();if(!show_tiered_prices){$(".sale-badge").each(function(){$(this).removeClass("hidden")})}if(isNaN(regularPrice.replace(",",""))){$(this).find(".free-price").text(regularPrice)}else if(show_tiered_prices){$(".purchaseSection .priceSection").each(function(){var price=regularPrice.replace(",","");if(price!=="Free"&&price!=="$"){for(var key in priceTierKeys){if(parseFloat(price)<=parseFloat(priceTierKeys[key])){var salePrice=price_tiers[priceTierKeys[key]];$("#original-product-price").html("");if(Number(discountPrice.replace(",",""))>0){$(this).find(".discount-price").text(salePrice)}else{$(this).find("#product-price").text(salePrice)}$(this).find(".price-currency").text("$");break}}}})}else if(!productSaleActive&&$(".purchaseSection .couponEligible").length>0){$(".purchaseSection .couponEligible").each(function(){var price=regularPrice.replace(",","");var updatedPrice=false;if(price!=="Free"&&price!=="$"){var discountObject=discountData(price,osdCart,false);var salePrice=discountObject.price;if(parseFloat(price)!==parseFloat(salePrice)){$(".ResponsiveProductLeft .purchaseSection .price").css("vertical-align","bottom");var discountMessage=function(cartDiscount,expressDiscount){if(cartDiscount.class=="fa-tag"){if(dcJSON.value>100){var couponValue="$"+dcJSON.value/100}else{var couponValue=dcJSON.value+"%"}return i18next.t("header:special_offer_get")+" "+couponValue+" "+i18next.t("header:off_with_your")+" "+dcJSON.name+" "+i18next.t("header:coupon")+"."}else if(typeof expressDiscount.monetary_discount=="undefined"||expressDiscount.monetary_discount==0||$(".quickCheckoutBtn").length==0){return i18next.t("header:buy_more_save_more_get")+" $"+cartDiscount.monetary_discount+" "+i18next.t("header:in_instant_savings")}else if(cartDiscount.monetary_discount==expressDiscount.monetary_discount){return i18next.t("header:buy_more_save_more_get")+" $"+cartDiscount.monetary_discount+" "+i18next.t("header:in_instant_savings_buy_now")+"."}else if(cartDiscount.monetary_discount!==expressDiscount.monetary_discount&&$(".quickCheckoutBtn").width()>0){return i18next.t("header:buy_more_save_more_get")+" $"+cartDiscount.monetary_discount+" "+i18next.t("header:in_instant_savings_buy_now")+" "+i18next.t("header:or")+" $"+expressDiscount.monetary_discount+" "+i18next.t("header:when_you_buy_it_now")}};if(typeof salePrice!=="undefined"&&salePrice.indexOf(".00")>=0){salePrice=salePrice.substring(0,salePrice.length-3)}$(this).find("#product-price").text(salePrice);$(this).find(".price-currency").text("$");$(this).prepend('<span  id="original-product-price" class="original-product-price" style="display:none;">$'+price+'<a href="#"  id="price-discount-anchor" class="popover-anchor" data-toggle="popover" data-trigger="hover" data-content="'+discountMessage(discountObject,discountData(price,0,false))+'" data-placement="right" data-html="true" data-original-title="" title=""><i class="fa '+discountObject.class+'"></i></a></span></span>');$("[data-toggle=popover]").popover();$(this).animate({height:55},300);$(".purchaseSection .couponEligible").css("display","block");$(".original-product-price").slideDown();updatedPrice=true}}if(!updatedPrice){if(Number(discountPrice.replace(",",""))>0){$("#original-product-price").html("$"+regularPrice);$(this).find(".discount-price").text(discountPrice)}else{$(this).find("#product-price").text(regularPrice)}$(this).find(".price-currency").text("$")}})}else{if(Number(discountPrice.replace(",",""))>0){$("#original-product-price").html("$"+regularPrice);$(this).find(".discount-price").text(discountPrice)}else{$(this).find("#product-price").text(regularPrice)}$(this).find(".price-currency").text("$")}$("#reviewModel .btn-primary").click(function(){var rateVal=document.getElementById("ratingNow").value;if(rateVal!==0&&parseInt(rateVal)==rateVal)$("#reviewFormAction").submit()});if(typeof feature_assignment_widget_url!=="undefined"){loadFeatureAssignmentWidget(true)}});if(isLoggedIn()&&typeof Cookies.get("fp_tabs")!=="undefined"){var tabs=Cookies.getJSON("fp_tabs");var tab_list=$("<ul class='fptab'><li class='active'>Product</li></ul>");for(var i=0;i<tabs.length;i++){tab_list.append("<li>"+tabs[i]+"</li>")}tab_list.append('<li class="close"><i class="fa fa-times-circle-o" aria-hidden="true"></i></li>');$("#fp_tabs").html(tab_list);var data={format:"json",afc:"Null",package:"PublishingR2",op:"getTab",nocache:Math.round(Math.random()*1e4)};data.productID=$("#ProductID").html();$("ul.fptab li.close").click(function(){data.stgTab="display_off";$.ajax({url:reviewServiceUrl,data:data,dataType:"json"}).done(function(){location.reload()})});$("ul.fptab li").click(function(){if(!$(this).hasClass("active")){var tab_name="fp_"+$(this).html().toLowerCase().replace(" ","-");$(".fp_tab").hide();$("ul.fptab li").removeClass("active");if($("#"+tab_name).length==0){$("#editorialForms").append('<div id="'+tab_name+'" class="fp_tab"><i class="fa fa-refresh fa-spin" style="font-size:30px; padding:40px;"></i></div>');data.stgTab=tab_name;var xhr=$.ajax({url:reviewServiceUrl,data:data,dataType:"json"}).done(function(data,status,jqXHR){$("#"+jqXHR.fp_tab).html(data.PUBLISHINGR2_GETTAB_REPLY.HTML)});xhr.fp_tab=tab_name}$("#"+tab_name).show();$(this).addClass("active")}})}if(typeof Cookies.get("FP")!=="undefined"){Cookies.remove("FP",{path:"/",domain:"."+document.domain})}if(Cookies.get("CMSA")&&IsLicenseUpgradeEligible){var license_html="<strong>"+customMsaLicenseLabel+"</strong>";if(cmsaJSON.lu_price!==undefined)license_html+="&nbsp;&nbsp;&nbsp;"+cmsaJSON.lu_price;if($(".LicenseFAQ .LicenseUsesEditorial").length)license_html+='<div class="LicenseUses LicenseUsesEditorial">'+i18next.t("product:havas_editorial_tips")+"</div>";$(".LicenseFAQ").html(license_html)}
//# sourceMappingURL=product.js.map